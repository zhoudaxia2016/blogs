## CSS核心概念之选择器优先级

> CSS有很多要深刻理解的概念，所以最近开始详细研究一下它们。首先我们就先来看一下选择器的优先级，我觉得这是最最基础的概念了，而且有时候也非常让人疑惑。

我们一下顺序来了解一下吧：基本的选择器的优先级开始，CSS引入方式对优先级的影响，!important作用，伪类与伪元素。

> 我觉得现阶段也不着急关心浏览器的差别（初级或者入门阶段），所以我只有在火狐下测试过我的代码，其他浏览器一概不去试。

### 选择器优先级

选择器可以分为id选择器，类选择器，标签选择器，通配符选择器。这些分类不是随便分的，关系到它们的优先级是怎么计算的，同一种选择器，才能按数目来比较，不同的选择器不用比较，直接由上面的顺序就决定了它们的优先级。

我们可以理解为除了通佩符其他选择器都会给它的代码一点权重。我们用三个数字来表示选择器的组合形成的权重，以便我们可以去量化它们的优先级，比较它们的优先级即比较它们形成的权重。

1. 一个id选择器：权重1，0，0
3. 一个类选择器：权重0，1，0
4. 一个标签选择器：权重0，0，1

当我们比较两个选择器的组合的时候，可以用类似定长的字符串的比较方法来比较它们。从左到右比较数字的大小，一旦比较出了较大的数字，则不用比较下去了，拥有较大数字的选择器组合的权重较高。

举个例子，css 代码:

<pre>
<code>
body p{
  color: blue;
}

p{
  color: red;
}
</code>
</pre>

那么p标签字体是什么颜色，答案是蓝色。因为第一段代码有两个标签选择器，权重为0，0，2。而第二段代码只有一个标签选择器，权重为0，0，1。前面两个0相同，只需要比较最后一个数字，所以很容易就得到结果了。其实好像也没必要说得这么清楚，只是要把这些概念写下来的话，还是要讲得清楚明白才行。

再一个例子，css代码：

<pre>
<code>
#id{
  color: blue;
}

.class{
  color: red;
}
</code>
</pre>

权重分别为1，0，0和0，1，0，当它们都是选择同一个元素时候，字体会显示为蓝色。

而\*即通配符选择器是没有权重的，即为0，0，0.无论其他什么选择器与它比都会比它权重高。而当权重相等的两个选择器组合，则最后定义的有效。

### CSS引入方式对优先级的影响

CSS引入到html文件有四种方法：

1. 内联样式
2. 通过link引入
3. 通过@import引入
4. 通过style标签

我一直以为，它们也像选择器一样，冥冥之中有一种优先顺序在它们之中。事实上除了内联样式权重比以上所有选择器都高，其他方式就只是一个引入方式而已，与优先级并无关系（这都是我试验出来的，大家不妨也试验一下，若有异议，可以一起讨论）。

> @import 在style标签里要在其他代码之前调用，除了@charset可以在它之前使用。

> 我比较好奇为什么好多人都说这些引入方式对优先级是有影响的，但是又不绝对，如果它们按照其他顺序引入的话。这和它们的引入方式没有任何关系这种说法有什么区别呢？
$
所以我们可以增加一个数字来表示权重了，增加的数字表示是否为内联样式（直接嵌入到html元素之中）。若是内联样式，则权重为1，0，0，0.其余的规则与上面一节不变。

### ！important使用

有时候我们想要一个属性值优先级最高，我们可以使用添加！important的方法来简单的实现。

<pre>
<code>
p{
  color: red !important;
}
</code>
</pre>

这样的话，其他没有使用!important的属性值都不是它的对手了，比内联样式还牛b。我们可以再加一个数字来表示是否添加了!important。这样的话若添加了!important，则属性值的权重为1，0，0，0，0.其余规则没有变化。

现在可以用五个数字来表示权重了。在没有使用!important的选择器组合里，选择器组合下的代码的优先级都是一样的，由选择器组合形成的权重来决定。而加了!important的属性值就和同一个选择器组合里其他属性值的权重就不一样了。

### 伪元素与伪类,还有属性选择器

这些都是一些特殊的选择器（关系选择器不需要关心，它们不会产生权重），它们也有一些比较特殊的特性。

属性选择器：
<pre>
<code>
[class]{
  background: red;
}
.p{
  background: blue;
}
</code>
</pre>
假设有一个类属性为p的元素，那么以上代码的结果是该元素背景色为蓝色。当我们交换以上代码的顺序：

<pre>
<code>
.p{
  background: blue;
}
[class]{
  background: red;
}
</code>
</pre>

那么该元素的背景色为红色。这说明了什么？属性选择器与类选择器权重是一样的，都是0，0，0，1，0.

我们也可以用同样的方法得到伪类选择器与类选择器的权重也是一样的。所以说嘛，伪类可不是随便叫作伪类的，它的名字是大有来头的,伪类就是给元素添加了一个类,所以它的权重才和类选择器是一样的。比如:hover伪类，其实就是当鼠标在某个元素上面时，该元素就会添加一个叫作hover的类别，:hover可以选中这个类。

那么伪元素是不是给某个元素添加一个子元素？它是不是具有标签选择器的权重？
我们来看看最后的一个例子：
html：

<pre>
<code>
&ltp>&ltspan id="span">H&lt/span>ello!&lt/p>
</code>
</pre>

css:
<pre>
<code>
:first-letter{
  color: red;
}
#span{
  color: blue !important;
}
</code>
</pre>

最后的结果是Hello的第一个字母显示为红色，伪元素比id选择器与!important声明都牛b！它不是叫做伪元素吗？不是应该与标签（标签也能叫作元素）有相同的权重吗？

为了圆我的‘理论’，我思考了很久，最终认为是first-letter真的是一个子元素，可是它是不存在的，和\<span\>H\</span\>不是同一个元素，它是\<first-letter>H\</first-letter/>，是一个虚拟的元素，我们是选不了它的，除了通过:first-letter。

### 总结

这些理论都是通过查阅别人的博客加上自己的实践得来的，可能不一定准确，不过欢迎大家来讨论。
